import requests
import logging

# Set up logging
logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(levelname)s - %(message)s')

# Replace with your API key and desired hash string
api_key = ""
hash_string = ""

# VirusShare API URL
url = f"https://virusshare.com/apiv2/file?apikey={api_key}&hash={hash_string}"

def fetch_virusshare_data(api_url):
    try:
        # Make a GET request to the API
        response = requests.get(api_url)

        # Check if the request was successful (status code 200)
        if response.status_code == 200:
            # Print and log the JSON response
            logging.info("JSON Response:")
            data = response.json()
            logging.info(data)

            # Check for specific malware in the scans
            if "virustotal" in data and "scans" in data["virustotal"]:
                scans = data["virustotal"]["scans"]
                if "Carberp" in str(scans):
                    logging.info("[!] Carberp detected in the scans.")
                else:
                    logging.info("Carberp not detected in the scans.")
            else:
                logging.warning("No 'virustotal' or 'scans' field found in the response.")
        else:
            logging.error(f"Request failed with status code: {response.status_code}")
            logging.error(response.text)

    except Exception as e:
        logging.error(f"An error occurred: {str(e)}")

# Execute the function
fetch_virusshare_data(url)
