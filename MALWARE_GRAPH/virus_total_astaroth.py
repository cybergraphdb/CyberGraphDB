import json

import requests

url = "https://www.virustotal.com/api/v3/files/f7198035cce341240181d005c7b022e0"


headers = {
    "accept": "application/json",
    "x-apikey": "7883f503256ffab63e52ac70d6ec1fb12c039c47b5b4e72323e2974237508da0",
}

response = requests.get(url, headers=headers)

# print(response.text)

# Carica il JSON
data = json.loads(response.text)
if "Carberp" in str(data):
    print("Let's go")


# Estrai le informazioni sui "popular threat"
popular_threat_classification = data["data"]["attributes"][
    "popular_threat_classification"
]
popular_threat_label = popular_threat_classification["suggested_threat_label"]
popular_threat_category = popular_threat_classification["popular_threat_category"]
popular_threat_name = popular_threat_classification["popular_threat_name"]

# Stampare i risultati
print("Suggested Threat Label:", popular_threat_label)
print("Popular Threat Categories:")
for category in popular_threat_category:
    print("- Category:", category["value"], "Count:", category["count"])
print("Popular Threat Names:")
for name in popular_threat_name:
    print("- Name:", name["value"], "Count:", name["count"])
